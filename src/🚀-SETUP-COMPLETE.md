# โ ุฅุนุฏุงุฏ ูุธุงู ุงูุญุถูุฑ ุงูุฐูู - ููุชูู

## ๐ฏ ุงูุญุงูุฉ: ุฌุงูุฒ ููุชุดุบูู

ุชู ุชุญุฏูุซ ุงููุธุงู ุจุงููุงูู ูููุงู ููุชุทูุจุงุชู. ุงูุฃุฏูุงุฑ ุงูุขู ูู:
- โ **student** (ุทุงูุจ)
- โ **teacher** (ูุฏุฑุณ) 
- โ **supervisor** (ูุดุฑู)

---

## ๐ ุงูุฎุทูุงุช ุงูููุงุฆูุฉ (ูุฑุฉ ูุงุญุฏุฉ ููุท)

### ุงูุฎุทูุฉ 1๏ธโฃ: ุชุทุจูู Schema ูู Supabase

1. ุงูุชุญ: https://supabase.com/dashboard/project/bscxhshnubkhngodruuj/sql
2. ุงูุณุฎ ูุญุชูู ููู `/supabase-schema.sql` ูุงููุงู
3. ุงูุตูู ูู ูุญุฑุฑ SQL
4. ุงุถุบุท **Run** ุฃู `Ctrl+Enter`
5. ุงูุชุธุฑ ุฑุณุงูุฉ ุงููุฌุงุญ โ

> **ูุงู:** ุฅุฐุง ูุงู Schema ููุฌูุฏุงู ูุณุจูุงูุ ุณูุชู ุชุญุฏูุซ ุงูุฃุฏูุงุฑ ุชููุงุฆูุงู ุฏูู ูุดุงูู.

---

### ุงูุฎุทูุฉ 2๏ธโฃ: ุชุนุทูู Email Confirmation

1. ุงูุชุญ: https://supabase.com/dashboard/project/bscxhshnubkhngodruuj/settings/auth
2. ุงุจุญุซ ุนู: **"Enable email confirmations"**
3. ุงุฌุนููุง: **OFF** โ
4. ุงุญูุธ ุงูุชุบููุฑุงุช

---

### ุงูุฎุทูุฉ 3๏ธโฃ: ุงุฎุชุจุฑ ุงููุธุงู ๐

#### ุชุณุฌูู ุญุณุงุจ ุฌุฏูุฏ:
```
ุงูุจุฑูุฏ: test.student@kku.edu.sa
ูููุฉ ุงููุฑูุฑ: 123456
ุงูุงุณู: ุงุณู ุงูุทุงูุจ
ุงูุฏูุฑ: student
ุงูุฑูู ุงูุฌุงูุนู: 12345678
```

#### ุณูุชู:
1. โ ุฅูุดุงุก ุญุณุงุจ ูู `auth.users`
2. โ ุฅูุดุงุก profile ุชููุงุฆูุงู ูู `profiles` (ุนุจุฑ Trigger)
3. โ ุชุณุฌูู ุฏุฎูู ููุฑู
4. โ ุชูุฌูู ูููุญุฉ ุงูุชุญูู ุงูููุงุณุจุฉ ุญุณุจ ุงูุฏูุฑ

---

## ๐ ุงูุชุญูู ูู ูุฌุงุญ ุงูุฅุนุฏุงุฏ

### ูู Supabase (Table Editor):
```sql
SELECT * FROM public.profiles;
```
ูุฌุจ ุฃู ุชุฑู:
- โ ุงูุนููุฏ `role` ุจุงูููู: `student`, `teacher`, `supervisor`
- โ DEFAULT value ููู role = `'student'`

### ูู ุงูุชุทุจูู:
1. โ ุชุณุฌูู ุญุณุงุจ ุฌุฏูุฏ ูุนูู
2. โ ุชุณุฌูู ุงูุฏุฎูู ูุนูู
3. โ ููุญุฉ ุงูุชุญูู ุชุธูุฑ ุญุณุจ ุงูุฏูุฑ
4. โ ูุง ููุฌุฏ ุฎุทุฃ "ุจุฏูู ุฏูุฑ"

---

## ๐ ุฃููุงุน ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุช

### ๐จโ๐ **student** (ุงูุทุงูุจ)
- โ ุชุณุฌูู ุงูุญุถูุฑ (Code, QR, WebAuthn)
- โ ุนุฑุถ ุฌุฏููู ุงูุฏุฑุงุณู
- โ ุนุฑุถ ุณุฌู ุญุถูุฑู ุงูุดุฎุตู
- โ ุฅุฏุงุฑุฉ ุงูุจุตูุฉ ุงูุจูููุชุฑูุฉ

### ๐จโ๐ซ **teacher** (ุงููุฏุฑุณ)
- โ ุฅูุดุงุก ุฌูุณุงุช ุญุถูุฑ
- โ ุฅุฏุงุฑุฉ ุงูุฃูุณุงู ูุงูููุงุฏ
- โ ุนุฑุถ ุชูุงุฑูุฑ ุงูุญุถูุฑ ูุทูุงุจู
- โ ุชุนุฏูู ุญุงูุฉ ุงูุญุถูุฑ

### ๐ค **supervisor** (ุงููุดุฑู)
- โ ุนุฑุถ ุฌููุน ุงููุณุชุฎุฏููู
- โ ุฅุฏุงุฑุฉ ุงูุญุณุงุจุงุช (ุชุนุฏููุ ุญุฐู)
- โ ุชูุงุฑูุฑ ุดุงููุฉ ููู ุงููุธุงู
- โ ุฅุฏุงุฑุฉ ุงูููุงุฏ ูุงูุฃูุณุงู ูุงูุฌุฏุงูู
- โ ุตูุงุญูุงุช ูุงููุฉ

---

## ๐ ุงูุชุญูู ูู ุงูุจุฑูุฏ ุงูุฌุงูุนู

ุงููุธุงู ููุจู ููุท:
```
*.@kku.edu.sa
```

ุฅุฐุง ุญุงูู ุงููุณุชุฎุฏู ุงูุชุณุฌูู ุจุจุฑูุฏ ุขุฎุฑุ ุณูุธูุฑ ุฎุทุฃ:
```
โ๏ธ ูุฌุจ ุงุณุชุฎุฏุงู ุงูุจุฑูุฏ ุงูุฌุงูุนู (@kku.edu.sa) ููุท
```

---

## ๐ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### โ "Email not confirmed"
**ุงูุญู:**
1. ุงูุชุญ: https://supabase.com/dashboard/project/bscxhshnubkhngodruuj/settings/auth
2. ุนุทูู: **Enable email confirmations** โ

---

### โ "duplicate key value violates unique constraint"
**ุงูุญู:** ุชู ุญูู ุชููุงุฆูุงู! ุงููุธุงู ุงูุขู ูุณุชุฎุฏู:
```sql
ON CONFLICT (id) DO UPDATE
```

---

### โ "ุฏูุฑ ุงููุณุชุฎุฏู ุบูุฑ ูุนุฑูู"
**ุงูุญู:** ุชู ุญูู! ุงูุขู `role` ูู DEFAULT value = `'student'`

---

### โ "PGRST205: relation 'public.profiles' does not exist"
**ุงูุญู:**
1. ุงูุชุญ SQL Editor ูู Supabase
2. ุดุบู ูุญุชูู `/supabase-schema.sql`

---

## ๐ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ (Environment Variables)

ุฅุฐุง ููุช ุชุฑูุฏ ูุดุฑ ุงููุธุงู ุนูู Vercel/Netlify:

```env
VITE_SUPABASE_URL=https://bscxhshnubkhngodruuj.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJzY3hoc2hudWJraG5nb2RydXVqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3MDgzODUsImV4cCI6MjA3ODI4NDM4NX0._cszwMx3Yty-pl0Ip6IKlSctk7HxBJ4pN6ehLpkAEqY
```

**ููุงุญุธุฉ:** ุงูููุงุชูุญ ููุฌูุฏุฉ ุจุงููุนู ูู ุงูููุฏุ ูุง ุฏุงุนู ูุฅุถุงูุชูุง ุฅูุง ุนูุฏ ุงููุดุฑ.

---

## โ ูุงุฆูุฉ ุงูุงุฎุชุจุงุฑ ุงูููุงุฆูุฉ

### ุชุณุฌูู ุญุณุงุจ ุฌุฏูุฏ:
- [ ] ุทุงูุจ (student) ูุน ุฑูู ุฌุงูุนู
- [ ] ูุฏุฑุณ (teacher) ุจุฏูู ุฑูู ุฌุงูุนู
- [ ] ูุดุฑู (supervisor)

### ุชุณุฌูู ุงูุฏุฎูู:
- [ ] ูุนูู ุจูุฌุงุญ
- [ ] ูุธูุฑ ุงุณู ุงููุณุชุฎุฏู ูุฏูุฑู ูู Navbar
- [ ] ูุชู ุชูุฌูู ูููุญุฉ ุงูุชุญูู ุงูุตุญูุญุฉ

### ููุญุงุช ุงูุชุญูู:
- [ ] ุงูุทุงูุจ ูุฑู ููุญุชู ููุท
- [ ] ุงููุฏุฑุณ ูุฑู ุฃุฏูุงุชู
- [ ] ุงููุดุฑู ูุฑู ูู ุดูุก

### ุงูุญูุงูุฉ:
- [ ] ุงูุทุงูุจ ูุง ูุณุชุทูุน ุงููุตูู ูููุญุฉ ุงููุฏุฑุณ
- [ ] ุงููุฏุฑุณ ูุง ูุณุชุทูุน ุงููุตูู ูููุญุฉ ุงููุดุฑู
- [ ] ุฑุณุงุฆู "Access Denied" ุชุธูุฑ ุจุดูู ุตุญูุญ

### ุงููุบุฉ ูุงููุถุน:
- [ ] ุงูุชุจุฏูู ุจูู ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ ูุนูู
- [ ] ุงููุถุน ุงููููู/ุงูููุงุฑู ูุนูู
- [ ] ุงูุชูุฌูู RTL/LTR ุตุญูุญ

---

## ๐ ูุจุฑูู!

ุงููุธุงู ุงูุขู ุฌุงูุฒ ุจุงููุงูู ูุน:
- โ ุฑุจุท ุญูููู ูุน Supabase Auth
- โ ุฃุฏูุงุฑ ูุญุฏุซุฉ (student, teacher, supervisor)
- โ ุฅูุดุงุก Profile ุชููุงุฆู ุนูุฏ ุงูุชุณุฌูู
- โ ุงูุชุญูู ูู ุงูุจุฑูุฏ ุงูุฌุงูุนู @kku.edu.sa
- โ ุญูุงูุฉ ูููุฉ ููุตูุญุงุช ุญุณุจ ุงูุฏูุฑ
- โ ููุญุงุช ุชุญูู ูููุตูุฉ ููู ุฏูุฑ
- โ ุฏุนู ูุงูู ููุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ
- โ ูุถุน ูููู/ููุงุฑู
- โ ุชุตููู ุงุญุชุฑุงูู ุจุฃููุงู ุงูุฌุงูุนุฉ

---

## ๐ ุฏุนู ุฅุถุงูู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:
1. ุชุฃูุฏ ูู ุชุทุจูู Schema ุจุดูู ูุงูู
2. ุชุฃูุฏ ูู ุชุนุทูู Email Confirmation
3. ุงูุญุต Console ูู ุงููุชุตูุญ (F12)
4. ุฑุงุฌุน ุงููููุงุช:
   - `/supabase-schema.sql`
   - `/lib/supabase.ts`
   - `/components/AuthPage.tsx`

---

**ุขุฎุฑ ุชุญุฏูุซ:** ููููุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 2.0 - ูุธุงู ุงูุฃุฏูุงุฑ ุงููุญุฏุซ
